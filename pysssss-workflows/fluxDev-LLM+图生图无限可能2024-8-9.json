{"last_node_id": 46, "last_link_id": 52, "nodes": [{"id": 14, "type": "CR Latent Input Switch", "pos": [1394, 572], "size": {"0": 315, "1": 78}, "flags": {}, "order": 24, "mode": 0, "inputs": [{"name": "latent1", "type": "LATENT", "link": 13}, {"name": "latent2", "type": "LATENT", "link": 12}], "outputs": [{"name": "LATENT", "type": "LATENT", "links": [21], "shape": 3, "slot_index": 0}, {"name": "show_help", "type": "STRING", "links": null, "shape": 3}], "properties": {"Node name for S&R": "CR Latent Input Switch"}, "widgets_values": [2]}, {"id": 27, "type": "GetNode", "pos": [1920, 192], "size": {"0": 210, "1": 58}, "flags": {"collapsed": true}, "order": 0, "mode": 0, "outputs": [{"name": "VAE", "type": "VAE", "links": [26], "slot_index": 0}], "title": "Get_VAE", "properties": {}, "widgets_values": ["VAE"]}, {"id": 22, "type": "VAEDecode", "pos": [2039, 82], "size": {"0": 210, "1": 46}, "flags": {}, "order": 29, "mode": 0, "inputs": [{"name": "samples", "type": "LATENT", "link": 22}, {"name": "vae", "type": "VAE", "link": 26}], "outputs": [{"name": "IMAGE", "type": "IMAGE", "links": [27], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "VAEDecode"}}, {"id": 20, "type": "ImageScale", "pos": [591.4746157226567, 859.1346738476553], "size": {"0": 210, "1": 122.5356674194336}, "flags": {}, "order": 15, "mode": 0, "inputs": [{"name": "image", "type": "IMAGE", "link": 17}, {"name": "width", "type": "INT", "link": 15, "widget": {"name": "width"}}, {"name": "height", "type": "INT", "link": 16, "widget": {"name": "height"}}], "outputs": [{"name": "IMAGE", "type": "IMAGE", "links": [18], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "ImageScale"}, "widgets_values": ["lanczos", 512, 512, "center"]}, {"id": 13, "type": "ImageScaleToTotalPixels", "pos": [829.4746157226567, 856.1346738476553], "size": {"0": 210, "1": 82}, "flags": {}, "order": 18, "mode": 0, "inputs": [{"name": "image", "type": "IMAGE", "link": 18}], "outputs": [{"name": "IMAGE", "type": "IMAGE", "links": [19], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "ImageScaleToTotalPixels"}, "widgets_values": ["nearest-exact", 1]}, {"id": 18, "type": "CM_NearestSDXLResolution", "pos": [371.4746157226568, 881.1346738476553], "size": {"0": 176.39999389648438, "1": 46}, "flags": {}, "order": 12, "mode": 0, "inputs": [{"name": "image", "type": "IMAGE", "link": 14}], "outputs": [{"name": "width", "type": "INT", "links": [15, 30], "shape": 3, "slot_index": 0}, {"name": "height", "type": "INT", "links": [16, 31], "shape": 3, "slot_index": 1}], "properties": {"Node name for S&R": "CM_NearestSDXLResolution"}}, {"id": 31, "type": "Reroute", "pos": [625.4746157226567, 659.1346738476553], "size": [75, 26], "flags": {}, "order": 16, "mode": 0, "inputs": [{"name": "", "type": "*", "link": 31, "widget": {"name": "value"}}], "outputs": [{"name": "", "type": "INT", "links": [33, 35], "slot_index": 0}], "properties": {"showOutputText": false, "horizontal": false}}, {"id": 30, "type": "Reroute", "pos": [603.4746157226567, 602.1346738476553], "size": [75, 26], "flags": {}, "order": 14, "mode": 0, "inputs": [{"name": "", "type": "*", "link": 30, "widget": {"name": "value"}}], "outputs": [{"name": "", "type": "INT", "links": [32, 34], "slot_index": 0}], "properties": {"showOutputText": false, "horizontal": false}}, {"id": 17, "type": "Note", "pos": [1399, 698], "size": {"0": 210, "1": 58}, "flags": {}, "order": 1, "mode": 0, "properties": {"text": ""}, "widgets_values": ["1\u662f\u3010\u6587\u751f\u56fe\u3011\u7a7a\u7684latent\n2\u662f\u3010\u56fe\u751f\u56fe\u3011\u56fe\u7247\u7f16\u7801\u540e\u7684latent"], "color": "#432", "bgcolor": "#653"}, {"id": 28, "type": "PreviewImage", "pos": [2286, 84], "size": {"0": 1223.444091796875, "1": 933.5021362304688}, "flags": {}, "order": 30, "mode": 0, "inputs": [{"name": "images", "type": "IMAGE", "link": 27}], "properties": {"Node name for S&R": "PreviewImage"}}, {"id": 32, "type": "Note", "pos": [1605, -59], "size": {"0": 210, "1": 106.20240020751953}, "flags": {}, "order": 2, "mode": 0, "properties": {"text": ""}, "widgets_values": ["ays+\u9700\u8981\u5b89\u88c5\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u8282\u70b9\uff1a\nhttps://github.com/pamparamm/ComfyUI-ppm\n\ndenoise\u964d\u566a\u52301\u5c31\u662f\u6587\u751f\u56fe\u4e86\n\u7684noise\u964d\u566a\u5c0f\u4e8e1\u6839\u636e\u6570\u503c\u5927\u5c0f\uff0c\u5f71\u54cd\u548c\u539f\u56fe\u7684\u76f8\u4f3c\u5ea6\u3002"], "color": "#432", "bgcolor": "#653"}, {"id": 3, "type": "ModelSamplingFlux", "pos": [937, -17], "size": {"0": 315, "1": 130}, "flags": {}, "order": 19, "mode": 0, "inputs": [{"name": "model", "type": "MODEL", "link": 1}, {"name": "width", "type": "INT", "link": 32, "widget": {"name": "width"}}, {"name": "height", "type": "INT", "link": 33, "widget": {"name": "height"}}], "outputs": [{"name": "MODEL", "type": "MODEL", "links": [6], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "ModelSamplingFlux"}, "widgets_values": [1.15, 0.5, 1024, 1024]}, {"id": 2, "type": "CheckpointLoaderSimple", "pos": [-240, 221], "size": {"0": 315, "1": 98}, "flags": {}, "order": 3, "mode": 0, "outputs": [{"name": "MODEL", "type": "MODEL", "links": [1], "shape": 3, "slot_index": 0}, {"name": "CLIP", "type": "CLIP", "links": [8, 28], "shape": 3, "slot_index": 1}, {"name": "VAE", "type": "VAE", "links": [11, 25], "shape": 3, "slot_index": 2}], "properties": {"Node name for S&R": "CheckpointLoaderSimple"}, "widgets_values": ["flux\\flux1-dev-fp8.safetensors"]}, {"id": 34, "type": "Florence2Run", "pos": [31.461319385156212, -242.58979027500004], "size": {"0": 400, "1": 352}, "flags": {}, "order": 13, "mode": 0, "inputs": [{"name": "image", "type": "IMAGE", "link": 36}, {"name": "florence2_model", "type": "FL2MODEL", "link": 37, "slot_index": 1}], "outputs": [{"name": "image", "type": "IMAGE", "links": null, "shape": 3}, {"name": "mask", "type": "MASK", "links": null, "shape": 3}, {"name": "caption", "type": "STRING", "links": [38], "shape": 3, "slot_index": 2}, {"name": "data", "type": "JSON", "links": null, "shape": 3}], "properties": {"Node name for S&R": "Florence2Run"}, "widgets_values": ["", "more_detailed_caption", true, false, 1024, 3, true, "", 570136144043241, "randomize"]}, {"id": 26, "type": "SetNode", "pos": [221, 399], "size": {"0": 210, "1": 58}, "flags": {"collapsed": true}, "order": 11, "mode": 0, "inputs": [{"name": "VAE", "type": "VAE", "link": 25}], "outputs": [{"name": "*", "type": "*", "links": null}], "title": "Set_VAE", "properties": {"previousName": "VAE"}, "widgets_values": ["VAE"]}, {"id": 33, "type": "Florence2ModelLoader", "pos": [-356.538680614844, -205.58979027500004], "size": {"0": 315, "1": 106}, "flags": {}, "order": 4, "mode": 0, "inputs": [{"name": "lora", "type": "PEFTLORA", "link": null}], "outputs": [{"name": "florence2_model", "type": "FL2MODEL", "links": [37], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "Florence2ModelLoader"}, "widgets_values": ["Florence-2-large", "fp16", "sdpa"]}, {"id": 11, "type": "KSampler", "pos": [1583, 93], "size": {"0": 315, "1": 262}, "flags": {}, "order": 28, "mode": 0, "inputs": [{"name": "model", "type": "MODEL", "link": 6}, {"name": "positive", "type": "CONDITIONING", "link": 7}, {"name": "negative", "type": "CONDITIONING", "link": 29}, {"name": "latent_image", "type": "LATENT", "link": 21}], "outputs": [{"name": "LATENT", "type": "LATENT", "links": [22], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "KSampler"}, "widgets_values": [596666806535792, "randomize", 20, 1, "deis", "normal", 0.85]}, {"id": 4, "type": "CLIPTextEncodeFlux", "pos": [871, 195], "size": {"0": 366.7416687011719, "1": 127.23472595214844}, "flags": {}, "order": 27, "mode": 0, "inputs": [{"name": "clip", "type": "CLIP", "link": 8}, {"name": "t5xxl", "type": "STRING", "link": 50, "widget": {"name": "t5xxl"}}], "outputs": [{"name": "CONDITIONING", "type": "CONDITIONING", "links": [7], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "CLIPTextEncodeFlux"}, "widgets_values": ["", "", 3.5], "color": "#232", "bgcolor": "#353"}, {"id": 38, "type": "CR Text Input Switch", "pos": [840, -746], "size": {"0": 315, "1": 126}, "flags": {}, "order": 21, "mode": 0, "inputs": [{"name": "text1", "type": "STRING", "link": 42, "widget": {"name": "text1"}}, {"name": "text2", "type": "STRING", "link": 45, "widget": {"name": "text2"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": [46], "shape": 3, "slot_index": 0}, {"name": "show_help", "type": "STRING", "links": null, "shape": 3}], "properties": {"Node name for S&R": "CR Text Input Switch"}, "widgets_values": [1, "", ""]}, {"id": 43, "type": "CR Text Input Switch (4 way)", "pos": [1839, -955], "size": {"0": 315, "1": 174}, "flags": {}, "order": 25, "mode": 0, "inputs": [{"name": "text1", "type": "STRING", "link": 47, "widget": {"name": "text1"}}, {"name": "text2", "type": "STRING", "link": 51, "widget": {"name": "text2"}}, {"name": "text3", "type": "STRING", "link": 52, "widget": {"name": "text3"}}, {"name": "text4", "type": "STRING", "link": null, "widget": {"name": "text4"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": [48], "shape": 3, "slot_index": 0}, {"name": "show_help", "type": "STRING", "links": [], "shape": 3, "slot_index": 1}], "properties": {"Node name for S&R": "CR Text Input Switch (4 way)"}, "widgets_values": [1, "", "", "", ""]}, {"id": 37, "type": "LLM", "pos": [1200, -1029], "size": {"0": 577.5795288085938, "1": 647.1538696289062}, "flags": {}, "order": 23, "mode": 0, "inputs": [{"name": "model", "type": "CUSTOM", "link": 40}, {"name": "images", "type": "IMAGE", "link": null}, {"name": "extra_parameters", "type": "DICT", "link": null}, {"name": "system_prompt_input", "type": "STRING", "link": null, "widget": {"name": "system_prompt_input"}}, {"name": "user_prompt_input", "type": "STRING", "link": null, "widget": {"name": "user_prompt_input"}}, {"name": "tools", "type": "STRING", "link": null, "widget": {"name": "tools"}}, {"name": "file_content", "type": "STRING", "link": null, "widget": {"name": "file_content"}}, {"name": "user_prompt", "type": "STRING", "link": 46, "widget": {"name": "user_prompt"}}], "outputs": [{"name": "assistant_response", "type": "STRING", "links": [47], "shape": 3, "slot_index": 0}, {"name": "history", "type": "STRING", "links": null, "shape": 3}, {"name": "tool", "type": "STRING", "links": null, "shape": 3}, {"name": "image", "type": "IMAGE", "links": null, "shape": 3}], "properties": {"Node name for S&R": "LLM"}, "widgets_values": ["You are an art describer who describes images using text as if you were\na professional art critic with extensive knowledge. When given any image,\ntreat it as if it is a brief artwork description, then expand on it\nwhilst keeping the original style, subject and any quoted text. Focus on:\n\n1. The main subject (describe in more detail)\n2. The artistic style\n3. The background or setting\n4. How the quoted text is shown\n\nBe creative but stay true to the original concept.\n\n\u2022 Create a single paragraph description\n\u2022 Focus on details that would be relevant for image generation\n\u2022 Maintain the style of Stable Diffusion prompts\n\u2022 Keep the original concept intact while adding creative details\n\u2022 Maintain  any text in quotes\n\u2022 Do not ask any questions at the end - follow the rules!\n\u2022 Do not add any preamble", "", 0.7, "enable", "disable", "disable", "enable", 1920, "", "", "", "", "", 100, "", true]}, {"id": 36, "type": "LLM_api_loader", "pos": [834, -940], "size": {"0": 315, "1": 130}, "flags": {}, "order": 5, "mode": 0, "outputs": [{"name": "model", "type": "CUSTOM", "links": [40], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "LLM_api_loader"}, "widgets_values": ["llama3.1", "http://127.0.0.1:11434/v1/", "ollama", false]}, {"id": 42, "type": "Note", "pos": [582, -773], "size": {"0": 210, "1": 58}, "flags": {}, "order": 6, "mode": 0, "properties": {"text": ""}, "widgets_values": ["- \u90091\u662fFlorence\u5199\u7684\u63d0\u793a\u8bcd\n- \u90092\u662f\u81ea\u5df1\u5199\u7684\u63d0\u793a\u8bcd"], "color": "#432", "bgcolor": "#653"}, {"id": 35, "type": "ShowText|pysssss", "pos": [464, -219], "size": {"0": 293.8005676269531, "1": 204.20362854003906}, "flags": {}, "order": 17, "mode": 0, "inputs": [{"name": "text", "type": "STRING", "link": 38, "widget": {"name": "text"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": [42, 51], "shape": 6, "slot_index": 0}], "properties": {"Node name for S&R": "ShowText|pysssss"}, "widgets_values": ["", "The image shows a young man with long dark hair, sitting in a cave and eating a bowl of food with chopsticks. He is holding the bowl with both hands and appears to be deep in thought as he takes a bite out of the food. The background is dark and the cave walls are made of stone, giving the impression that the man is in a dimly lit room. The overall mood of the image is somber and contemplative."]}, {"id": 41, "type": "String Literal", "pos": [470, -634], "size": {"0": 292.9652404785156, "1": 175.2615966796875}, "flags": {}, "order": 7, "mode": 0, "outputs": [{"name": "STRING", "type": "STRING", "links": [45, 52], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "String Literal"}, "widgets_values": [""]}, {"id": 46, "type": "Note", "pos": [1847, -737], "size": {"0": 218.60394287109375, "1": 96.89305114746094}, "flags": {}, "order": 8, "mode": 0, "properties": {"text": ""}, "widgets_values": ["- \u90091\u662fllama3.1\u4f18\u5316\u540e\u7684\u63d0\u793a\u8bcd\n- \u90092\u662fFlorence\u5199\u7684\u63d0\u793a\u8bcd\n- \u90093\u662f\u81ea\u5df1\u5199\u7684\u63d0\u793a\u8bcd"], "color": "#432", "bgcolor": "#653"}, {"id": 44, "type": "ShowText|pysssss", "pos": [2236, -952], "size": {"0": 372.9077453613281, "1": 357.35357666015625}, "flags": {}, "order": 26, "mode": 0, "inputs": [{"name": "text", "type": "STRING", "link": 48, "widget": {"name": "text"}}], "outputs": [{"name": "STRING", "type": "STRING", "links": [50], "shape": 6, "slot_index": 0}], "properties": {"Node name for S&R": "ShowText|pysssss"}, "widgets_values": ["", "In this haunting scene unfold the contours of a young wanderer suspended in introspection - The figure of the young man situated in a cave environment epitomizes quiet solitude, much like Bash\u014d's words resonate within quoted reflection \"Nature which wrecks a pleasure always brings us up again\": his gaze absorbed and fingers grasping for sustenance. Every detail draws to itself an undeniable somberness, the rugged stones encasing him mirroring inner turmoil.\n\nWithin this frame we enter an ambiance of melancholic simplicity where the primary element - our subject with raven-dark locks - sits as both hands enveloping his alms: chopsticks bridled, then dipping delicately into awaiting consumption much-like the unfolding narrative one senses - A reflective space imbued deeply where thoughts and silence cohabitate, even in these moments - perhaps we may see within the gentle grasp and fluid gestures at consuming sustenance an unseen story unfold."]}, {"id": 15, "type": "VAEEncode", "pos": [1130, 676], "size": {"0": 210, "1": 46}, "flags": {}, "order": 22, "mode": 0, "inputs": [{"name": "pixels", "type": "IMAGE", "link": 19}, {"name": "vae", "type": "VAE", "link": 11}], "outputs": [{"name": "LATENT", "type": "LATENT", "links": [12], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "VAEEncode"}}, {"id": 16, "type": "EmptySD3LatentImage", "pos": [1130, 524], "size": {"0": 210, "1": 106}, "flags": {}, "order": 20, "mode": 0, "inputs": [{"name": "width", "type": "INT", "link": 34, "widget": {"name": "width"}}, {"name": "height", "type": "INT", "link": 35, "widget": {"name": "height"}}], "outputs": [{"name": "LATENT", "type": "LATENT", "links": [13], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "EmptySD3LatentImage"}, "widgets_values": [1024, 1024, 1]}, {"id": 29, "type": "CLIPTextEncode", "pos": [868, 376], "size": {"0": 388.1771240234375, "1": 76}, "flags": {}, "order": 10, "mode": 0, "inputs": [{"name": "clip", "type": "CLIP", "link": 28}], "outputs": [{"name": "CONDITIONING", "type": "CONDITIONING", "links": [29], "shape": 3, "slot_index": 0}], "properties": {"Node name for S&R": "CLIPTextEncode"}, "widgets_values": [""], "color": "#322", "bgcolor": "#533"}, {"id": 12, "type": "LoadImage", "pos": [-433, 484], "size": {"0": 546.2438354492188, "1": 517.8359985351562}, "flags": {}, "order": 9, "mode": 0, "outputs": [{"name": "IMAGE", "type": "IMAGE", "links": [14, 17, 36], "shape": 3, "slot_index": 0}, {"name": "MASK", "type": "MASK", "links": null, "shape": 3}], "properties": {"Node name for S&R": "LoadImage"}, "widgets_values": ["\u6b66\u529f\u9ad8\u5f3a\u4e5f\u8981\u5403\u6cd5_10640.jpg", "image"]}], "links": [[1, 2, 0, 3, 0, "MODEL"], [6, 3, 0, 11, 0, "MODEL"], [7, 4, 0, 11, 1, "CONDITIONING"], [8, 2, 1, 4, 0, "CLIP"], [11, 2, 2, 15, 1, "VAE"], [12, 15, 0, 14, 1, "LATENT"], [13, 16, 0, 14, 0, "LATENT"], [14, 12, 0, 18, 0, "IMAGE"], [15, 18, 0, 20, 1, "INT"], [16, 18, 1, 20, 2, "INT"], [17, 12, 0, 20, 0, "IMAGE"], [18, 20, 0, 13, 0, "IMAGE"], [19, 13, 0, 15, 0, "IMAGE"], [21, 14, 0, 11, 3, "LATENT"], [22, 11, 0, 22, 0, "LATENT"], [25, 2, 2, 26, 0, "*"], [26, 27, 0, 22, 1, "VAE"], [27, 22, 0, 28, 0, "IMAGE"], [28, 2, 1, 29, 0, "CLIP"], [29, 29, 0, 11, 2, "CONDITIONING"], [30, 18, 0, 30, 0, "*"], [31, 18, 1, 31, 0, "*"], [32, 30, 0, 3, 1, "INT"], [33, 31, 0, 3, 2, "INT"], [34, 30, 0, 16, 0, "INT"], [35, 31, 0, 16, 1, "INT"], [36, 12, 0, 34, 0, "IMAGE"], [37, 33, 0, 34, 1, "FL2MODEL"], [38, 34, 2, 35, 0, "STRING"], [40, 36, 0, 37, 0, "CUSTOM"], [42, 35, 0, 38, 0, "STRING"], [45, 41, 0, 38, 1, "STRING"], [46, 38, 0, 37, 7, "STRING"], [47, 37, 0, 43, 0, "STRING"], [48, 43, 0, 44, 0, "STRING"], [50, 44, 0, 4, 1, "STRING"], [51, 35, 0, 43, 1, "STRING"], [52, 41, 0, 43, 2, "STRING"]], "groups": [{"title": "Florence", "bounding": [-367, -301, 1168, 436], "color": "#3f789e", "font_size": 24, "locked": false}, {"title": "LLM Party", "bounding": [431, -1152, 2190, 806], "color": "#3f789e", "font_size": 24, "locked": false}, {"title": "\u8ba1\u7b97\u5c3a\u5bf8", "bounding": [361, 558, 688, 434], "color": "#3f789e", "font_size": 24, "locked": false}], "config": {}, "extra": {"ds": {"scale": 0.19784466890013577, "offset": [2400.4366637589296, 1528.8663274739836]}}, "version": 0.4}